<html>

<head></head>

<body>
  <h1>svg foreignObject to embed html</h1>

  <svg id="elementToCapture" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 300" x="0" y="0" height="300"
    width="300">

    <circle r="142" cx="150" cy="150" fill="none" stroke="#000000" stroke-width="2" />

    <foreignObject x="50" y="50" width="200" height="200">
      <style>
        * {
          margin: 0;
          padding: 0;
        }
      </style>
      <div xmlns="http://www.w3.org/1999/xhtml" style="
            width: 196px; height: 196px;
            border: solid 2px #000000;
            font-size: 16px;
            overflow: hidden;
          ">
        <p>this is html in svg 1</p>
        <p>this is html in svg 2</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut pretium libero ipsum, a sodales quam vulputate
          eget. Donec id lorem at eros maximus semper. Quisque quis congue purus. Suspendisse est nisl, congue sed
          sapien eget, vehicula scelerisque sapien. Mauris nec ipsum sed lacus hendrerit auctor. Morbi viverra mollis
          justo, sit amet congue nibh malesuada at. Vivamus et nisi vel magna molestie vestibulum sollicitudin ac nulla.
          Quisque eget mi elementum ante elementum interdum ac non sem. Maecenas sed erat eget ex imperdiet mattis vitae
          at ligula. Integer quam tortor, laoreet vel tincidunt ac, imperdiet ac erat. Sed sagittis augue facilisis
          bibendum dapibus. Integer ut ornare dolor.</p>
      </div>
    </foreignObject>

  </svg>


  <button id="saveButton">Save as PNG</button>

  <script>
    // Function to capture and save the HTML element as a PNG image
    function saveAsPNG() {
      // Get a reference to the HTML element you want to capture
      const elementToCapture = document.getElementById('elementToCapture');

      // Create a new canvas element
      const canvas = document.createElement('canvas');
      const ctx = canvas.getContext('2d');

      // Create an HTMLImageElement to render the element's content
      const img = new Image();

      // Add an onload event to ensure the image is fully loaded
      img.onload = function () {
        // Set the canvas dimensions to match the element's dimensions
        //   canvas.width = elementToCapture.clientWidth;
        //   canvas.height = elementToCapture.clientHeight;

        // Calculate the dimensions for the canvas to achieve 300 DPI
        const dpi = 300;
        const scaleFactor = dpi / 96; // 96 DPI is the standard screen resolution
        const canvasWidth = elementToCapture.clientWidth * scaleFactor;
        const canvasHeight = elementToCapture.clientHeight * scaleFactor;

        // Set the canvas dimensions for 300 DPI
        canvas.width = canvasWidth;
        canvas.height = canvasHeight;
        canvas.style.width = `${elementToCapture.clientWidth}px`;
        canvas.style.height = `${elementToCapture.clientHeight}px`;

        // Scale the context to match the DPI
        ctx.scale(scaleFactor, scaleFactor);

        // Draw the image (element's content) on the canvas
        ctx.drawImage(img, 0, 0);

        // Convert the canvas content to a data URL (PNG format)
        const dataURL = canvas.toDataURL('image/png');

        // Create a link element to download the PNG image
        const downloadLink = document.createElement('a');
        downloadLink.href = dataURL;
        downloadLink.download = 'element.png'; // Specify the filename

        // Trigger a click event on the download link to start the download
        downloadLink.click();
      };

      // Set the source of the image to a data URL representing the element's content
      const elementHTML = new XMLSerializer().serializeToString(elementToCapture);
      img.src = 'data:image/svg+xml;base64,' + btoa(unescape(encodeURIComponent(elementHTML)));
      document.body.appendChild(img);
    }

    // Attach the saveAsPNG function to a button click event
    const saveButton = document.getElementById('saveButton');
    saveButton.addEventListener('click', saveAsPNG);
  </script>



</body>

</html>